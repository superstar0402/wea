# WIP: Ledger Nano S SDK

Crate that binds to the SDK (for now, no outside compilation option possible), exports bindings, as well as some safe wrappers.

- low-level automatically generated bindings to the SDK
- some safe wrappers over common syscalls
- IO abstractions

Will be published on [crates.io](crates.io) when ready.

## Usage

BUilding requires adding a toolchain to your Rust installation, and both Clang and arm-none-eabi-gcc.
The minimum required rustc version is 1.40.0.

- `rustup target add thumbv6m-none-eabi`
- install [Clang](http://releases.llvm.org/download.html).
- install an [ARM GCC toolchain](https://developer.arm.com/tools-and-software/open-source-software/developer-tools/gnu-toolchain/gnu-rm/downloads)

## Generating the bindings 

Pregenerated thin bindings to the sdk as a subrepo are already available for this project (in `./src/bindings.rs`).

It is not recommended to try to use any other SDK, as there are specific modifications contained in the bundled SDK that will not be available and prevent your app from working.

If you know those modifications and want to use another SDK, you can use `bindgen`: 

`cargo install bindgen`

Those can be generated by copy-pasting `wrapper.h` in the root of this directory to the root of the SDK, and then using the following command :

`TARGET=thumbv6m-none-eabi bindgen wrapper.h --use-core --no-prepend-enum-name --no-doc-comments --with-derive-default --no-derive-debug --ctypes-prefix=cty -- -fshort-enums -Ilib_ux/include -I. > bindings.rs`

Then, copy `bindings.rs` into the `src` folder of this project.

Note that `wrapper.h` contains flag definitions that might not match with your expected app configuration. You can change those before generating the bindings.
